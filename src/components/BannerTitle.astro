---
import { Image } from 'astro:assets';
import Breadcrumb from './Breadcrumb.astro';
import { getImages } from '../lib/utils';

const breadcrumbPosition = import.meta.env.BREADCRUMS_POSITION || 'bottom';
const { title, subtitle, image, width, height, crumbs=[] } = Astro.props;

let imageLocal = null;

if (image) {
  imageLocal = await getImages('banners', image);
}

const showBottom = Boolean(imageLocal);

const alt = title;
const widths = [768, 1024, 1440, 2000];
const formats = ['avif', 'webp', 'jpg'];
const sizes = "100vw";
---

<div class={`banner overflow-hidden relative ${imageLocal ? 'banner-image' : 'no-banner-image'}`}>
  {imageLocal && (
    <Image
      src={imageLocal.default}
      widths={widths}
      formats={formats}
      sizes={sizes}
      alt={alt}
      class="object-cover w-full h-full animate-zoom-out"
      decoding="async"
      loading="eager"
    />
  )}
  <div class={`banner-text flex flex-col items-center justify-center inset-0 ${imageLocal ? 'absolute' : ''}`}>
    <h1>{title}</h1>
    {subtitle && <h2>{subtitle}</h2>}
    { breadcrumbPosition === 'middle' && <Breadcrumb crumbs={crumbs} /> }
  </div>
</div>
{ breadcrumbPosition === 'bottom' && <Breadcrumb crumbs={crumbs} /> }
